---
title: 락
updated: 2023-01-20 07:34:50Z
created: 2023-01-20 07:26:57Z
latitude: 37.44491680
longitude: 127.13886840
altitude: 0.0000
sidebar: mydoc_sidebar1
permalink: Ⅰ.=프로그래밍=언어_03.=SQL_1.=ANSI=SQL_락.html
folder: mydoc
---

## Lock
- 같은 자원을 액세스 하려는 다중 트랜잭션 환경에서 순차적 진행을 보장하는 직렬화를 위한 메커니즘
<br>

## 종류

|이름|내용|
|--|--|
|공유 Lock<br>(Shared Lock)|데이터를 읽을때 사용<br>배타적 Lock과 호환되지 않고, 다른 공유 Lock과 호환 (=한 리소스에 두개 이상의 Lock 설정 가능)<br>자신이 읽고 있는 리소스를 다른 사용자가 읽을 수는 있어도 변경은 불가능|
|베타적 Lock<br>Exclusive Lock|데이터를 변경할때 사용<br>트랜잭션이 완료될 때까지 유지<br>해당 Lock이 해제될 때까지 다른 트랜잭션은 읽기와 변경이 불가능|

<br>

## 블로킹과 교착상태
- 블로킹
	- Lock 경합이 발생하여 특정 세션이 작업을 진행하지 못하고 멈춰 선 상태
	- 공유Lock과 배타적Lock 사이에서만 발생한다 (공유Lock 2개=호환가능, 배타적Lock 2개=불가능)
	- 커밋이나 롤백으로만 상태 해소가 가능 
	- 먼저 Lock을 설정한 트랜잭션이 완료될 때까지 후행 트랜잭션은 대기 (성능저하)
- Lock에 의한 성능 저하 최소화 방안
	- 트랜잭션을 가능한 짧게 정의
	- 같은 데이터를 갱신하는 트랜잭션이 동시에 수행되지 않도록 설계 (사용량 많은 시간대에 대용량 갱신 수행 주의)
	- 적절한 프로그래밍 기법 도입
	  ex) 대기시간 설정
	- 불필요한 트랜잭션 <ins>격리성</ins><sup>1</sup> 수준 상향조정 자제
	- SQL 문장이 가장 빠른시간 안에 처리를 완료하도록 설계
- 교착상태
	- 두 세션이 같은 리소스에 서로 액세스 하려고 마주보고 있는 상태
	- 둘 중 하나가 물러나지 않으면 해소되지 않으며, 발생시 DBMS가 둘 중 하나에 에러를 발생시켜 해결한다
	- 교착상태 방지를 위하여 Lock 성능저하 최소화 방안과 <ins>테이블 접근순서 정의</ins><sup>2</sup>, 갱신 Lock을 사용한다


<br>

---

**격리성**<sup>1</sup> = 실행중인 트랜잭션의 중간결과에 다른 트랜잭션 접근 못하는 특징
**테이블 접근순서 정의**<sup>2</sup> = `A 테이블 갱신후 B 테이블 갱신` 이라는 규칙을 정하고 모든 개발자가 준수하는 것
