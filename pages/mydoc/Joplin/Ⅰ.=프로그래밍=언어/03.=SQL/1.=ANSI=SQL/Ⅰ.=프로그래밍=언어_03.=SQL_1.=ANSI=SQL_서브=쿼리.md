---
title: 서브 쿼리
updated: 2023-01-20 06:41:17Z
created: 2023-01-18 08:08:33Z
latitude: 37.44491680
longitude: 127.13886840
altitude: 0.0000
sidebar: mydoc_sidebar1
permalink: Ⅰ.=프로그래밍=언어_03.=SQL_1.=ANSI=SQL_서브=쿼리.html
folder: mydoc
---

## 서브 쿼리
- SQL문에 포함 되어있는 또 다른 SQL문
- 메인 쿼리의 컬럼을 모두 이용 할 수 있으나, 메인 쿼리는 서브 쿼리의 컬럼 이용 불가능 (인라인 뷰는 예외)
- `SELECT`, `FROM`, `WHERE`, `HAVING`, `ORDER BY`에 사용 가능
- `INSERT`에 사용 가능
- `UPDATE`에 사용 가능
<br>

## 스칼라 서브 쿼리
- `SELECT`에서 한 개의 행, 한 개의 컬럼만 반환하는 서브 쿼리
- 메인 쿼리의 결과값 만큼 반복 실행되기 때문에 주의하여 사용해야 한다

```sql
SELECT ID
	   , (SELECT NICK_NAME FROM TEST_ANOTHER AS B WHERE A.ID = B.ID) AS NICK_NAME
FROM TEST AS A
```

<br>

## 인라인 뷰
- `FROM`에서 사용되는 서브 쿼리
- 쿼리가 실행될 때만 암시적으로 생성되는 동적 뷰

```sql
SELECT ID, NAME
FROM (
	SELECT 1 AS ID, 'AAA' AS NAME UNION ALL
	SELECT 2 AS ID, 'BBB' AS NAME 
) 
```

<br>

## 데이터 수정시 사용

```sql
UPDATE TEST
SET NAME = B.NAME
FROM TEST AS A
JOIN (
	SELECT X.ID, X.NAME
	FROM TEST_X AS X
	INNER JOIN TEST_Y AS Y
		ON X.ID = Y.ID
	WHERE Y.IS_YN = 'Y'
) AS B
	ON A.ID = B.ID
;
```
