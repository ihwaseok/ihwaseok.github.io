---
title: 기본 사용
updated: 2023-01-09 07:29:51Z
created: 2023-01-09 06:36:49Z
latitude: 37.44491680
longitude: 127.13886840
altitude: 0.0000
sidebar: mydoc_sidebar1
permalink: Ⅰ.=프로그래밍=언어_02.=Java=Script_2.=라이브러리_3)=jsTree_기본=사용.html
folder: mydoc
---

## div 태그 정의

```html
<div id="testTree" style="min-height:500px; overflow:auto;"></div>
```

<br>

## 트리 생성

```javascript
$('#testTree').jstree({ // 인스턴스 생성
	"core": { // 기본 옵션
		
		"animation": 0, // 열기, 닫기 애니메이션 지속시간
		"check_callback": true, // 트리구조 수정 결정 (false시, 생성, 이동, 삭제 등 상호작용 불가능)
		"themes": {"stripes": true}, // 테마설정 (배경 줄무늬)
		"data": { // ajax 형태로 데이터 받음 (url을 통해 반복으로 가져온다)
			
			"url": "/portal/test/tree",
			"data": function(node) {
				return {
					"deptId": node.id === '#' ? '' : node.id,
					"parentId": node.parent === '#' ? '' : node.parent
				} // data function end
			} // data end
			
		} // data end
		
	}, // core end
	"types": { // 미리 정의된 타입으로 노드 구성
		
		"#": {"valid_children": [ "root" ]}, // 루트 (자식으로 "root" 유형의 노드만 가질 수 있음)
		"root": {"icon": /*[[@{/site/img/group.png}]]*/ "", "valid_children": [ "folder" ]},
		"folder": {"icon": /*[[@{/site/img/group.png}]]*/ "", "valid_children": [ "folder", "leaf" ]},
		"leaf": {"icon": /*[[@{/site/img/male.png}]]*/ "", "valid_children": []}
		
	},
	"state": {"key": /*[[${menuNavigation.curMenu.menuId}]]*/ ''}, // 노드의 상태 저장
	"plugins": [ "state", "types", "wholerow", "checkbox" ]
}).on("loaded.jstree", function(e, data) { // 루트노드가 처음으로 로드된 뒤 이벤트
	$(this).jstree('open_node', 'allDept');
});
```

<br>

## 트리에게 데이터 전달하는 ajax 로직

```java
// HTML ~ Controller
@GetMapping("/portal/test/tree")
public List<JsTree> roleTree(@RequestParam @Nullable String deptId) {
	List<DeptDto> deptList = new ArrayList<>();
	
	if (deptId == null || deptId.equals("")) { // 처음 생성되어 선택된 노드가 없을 경우
		DeptDto deptDto = deptService.findDeptByDeptId("allDept");
		
		if (deptDto != null)
			deptDto.setParentId("#");
		
		deptList.add(deptDto);
	} else {
		deptList = deptService.findDeptByParentId(deptId);
	}

	List<JsTree> treeList = new ArrayList<>();
	for (DeptDto dto : deptList) {
		// 해당 노드의 속성 설정
		JsTreeDto treeDto = new JsTreeDto();
		treeDto.setNodeId(dto.getDeptId());
		treeDto.setNodeDescr(dto.getDeptName());
		treeDto.setParentId(dto.getParentId());
		treeDto.setDepth(dto.getDepth());
		long childCnt = deptService.countDeptByParentId(dto.getDeptId());
		treeDto.setChild((int) childCnt);

		// 트리 생성
		// 내부클래스 Builder 생성 반환 
		// → Builder의 속성인 JsTreeDto 생성 설정 반환 
		// → JsTree 생성하고 Dto에서 값받고 반환
		treeList.add(JsTree.builder().nodes(treeDto).build());
	}

	return treeList;
}
```

```java
// Controller ~ DB
// 부모 노드의 Id를 통해 자식 노드의 Id를 가져온다
@Transactional
@Override
public List<DeptDto> findDeptByParentId(String parentId) {
	return deptRepository.findDeptByParentId(parentId).stream()
			.map(p -> new DeptDto(p))
			.collect(Collectors.toList());
}
```
